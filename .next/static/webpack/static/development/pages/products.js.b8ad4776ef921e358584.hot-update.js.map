{"version":3,"file":"static/webpack/static\\development\\pages\\products.js.b8ad4776ef921e358584.hot-update.js","sources":["webpack:///./libs/authentication/index.ts"],"sourcesContent":["import nextCookie from \"next-cookies\";\r\nimport getUserFromToken from \"./getUserIdFromToken\";\r\nimport { NextPageContext } from \"next\";\r\nimport Router from \"next/router\";\r\n\r\nconst authentication = (context: NextPageContext) => {\r\n  // reads the token in cookie (checks if res in context exists) according to the res, runs for client or server side.\r\n  const { auth_token } = nextCookie(context);\r\n\r\n  // we check if the cookie is valid here. If token cannot be decoded, then it's invalid.\r\n  const user = getUserFromToken(auth_token);\r\n  // if called on server\r\n  if (context.res && !user) {\r\n    context.res.writeHead(302, { Location: \"/login/graphql\" });\r\n    context.res.end();\r\n    return;\r\n  }\r\n\r\n  // if called on client\r\n  if (!user) Router.push(\"/login/graphql\", \"/login\");\r\n};\r\n\r\nexport default authentication;\r\n"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AADA;AAAA;AACA;AACA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}